import{a as e}from"./chunk-MEABNXAK.js";import{a as d,b,d as I}from"./chunk-7NHJIUSQ.js";import"./chunk-V66ALGLP.js";function x({feature:s,selected:l,onToggle:o}){return e("button",{class:`w-full text-left border rounded-xl p-4 flex justify-between transition
        ${l?"border-primary-600 ring ring-primary-100":"border-gray-300"}`,onClick:o,children:[e("div",{class:"pr-4",children:[e("h5",{class:"font-medium",children:s.title}),e("p",{class:"text-xs text-gray-600 line-clamp-2",children:s.desc})]}),e("span",{class:`text-sm font-semibold self-start ${s.price?"":"text-gray-500"}`,children:s.price?`$${s.price}`:"Included"})]})}function $({steps:s,idx:l,setIdx:o}){let g=l/(s.length-1)*100;return e("div",{class:"relative mb-6",children:[e("div",{class:"absolute left-5 right-5 top-1/2 h-1 -translate-y-1/2 bg-gray-200 rounded"}),e("div",{class:"absolute left-5 top-1/2 h-1 -translate-y-1/2 bg-primary-600 rounded transition-all",style:{width:`${g}%`}}),e("div",{class:"relative flex gap-12 justify-between",children:s.map((i,p)=>e("button",{class:`w-10 h-10 rounded-full flex items-center justify-center font-bold
              ${p===l?"bg-primary-600 text-white":"bg-gray-200 text-gray-900"}`,onClick:()=>p<l&&o(p),style:{zIndex:1},children:p+1},p))})]})}function C({text:s}){let[l,o]=d(!1);return b(()=>{o(!1);let g=setTimeout(()=>o(!0),30);return()=>clearTimeout(g)},[s]),e("h3",{class:`text-lg font-semibold mb-4 transform transition-all duration-500 ease-out
        ${l?"opacity-100 translate-y-0":"opacity-0 translate-y-3"}`,children:s},s)}var E=s=>fetch(s).then(l=>l.json()),H=["Choose a base package","Select your web pages","Select your mobile screens","Review & checkout"],M=[{title:"Base package"},{title:"Web features"},{title:"Mobile features"},{title:"Review"}];function O(){let[s,l]=d({web:[],mobile:[]}),[o,g]=d({}),[i,p]=d("starter"),[u,S]=d([]),[n,h]=d(0),[f,j]=d(!1),[y,R]=d(12),[W,F]=d(!0),v=f?u:[...u].reverse();b(()=>{E("/api/features").then(l),E("/api/packages").then(t=>g(Object.fromEntries(t.map(a=>[a.key,a]))))},[]),b(()=>{if(!o[i]||s.web.length===0)return;let t=[...s.web,...s.mobile],a=(c,m=new Set)=>{if(m.has(c))return[];m.add(c);let T=o[c];return T?T.defaults.flatMap(w=>w.startsWith("@")?a(w.slice(1),m):w):[]},r=a(i);S(r.map(c=>t.find(m=>m.id===c)).filter(Boolean))},[i,o,s]);function A(t){if(t!==i){if(n!==0){p(t);return}F(!1),setTimeout(()=>{p(t),F(!0)},250)}}let P=t=>S(a=>a.some(r=>r.id===t.id)?a.filter(r=>r.id!==t.id):[...a,t]),{base:N,extras:B,total:k}=I(()=>{let t=(o[i]?.priceWeb??0)+(o[i]?.priceApp??0),a=o[i]?.defaults??[],r=u.filter(c=>!a.includes(c.id)).reduce((c,m)=>c+(m.price??0),0);return{base:t,extras:r,total:t+r}},[i,o,u]);return e("div",{class:"flex flex-col lg:flex-row gap-10",children:[e("div",{class:`relative lg:flex-1 cursor-pointer transition-opacity duration-250
          ${W?"opacity-100":"opacity-0"}
          ${f?"max-h-[70vh] overflow-y-auto p-2":""}`,onClick:()=>j(!f),children:f?e("div",{class:"grid auto-cols-fr grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:v.map(t=>e("img",{src:t.img??`https://images.unsplash.com/random/800x600?${encodeURIComponent(t.title)}&auto=compress`,alt:t.title,class:"w-full h-auto rounded-xl shadow-lg"},t.id))}):v.map((t,a)=>e("img",{src:t.img??`https://images.unsplash.com/random/800x600?${encodeURIComponent(t.title)}&auto=compress`,alt:t.title,class:"rounded-xl shadow-lg absolute transition-transform duration-300",style:{width:"280px",height:"180px",left:"50%",top:"15%",transform:`translate(-50%) rotate(${[-4,5,-6,8][a%4]}deg)`,zIndex:v.length-a}},t.id))}),e("aside",{class:"w-full lg:w-96 space-y-6",children:[e($,{steps:M,idx:n,setIdx:h}),e(C,{text:H[n]}),n===0&&e("div",{class:"space-y-4",children:Object.values(o).map(t=>e("button",{class:`w-full border rounded-xl p-4 text-left ${t.key===i?"border-primary-600 ring ring-primary-100":"border-gray-300"}`,onClick:()=>A(t.key),children:[e("div",{class:"flex justify-between",children:[e("span",{class:"font-medium",children:t.label}),e("span",{class:"font-semibold",children:t.priceWeb+t.priceApp>0?`$${t.priceWeb+t.priceApp}`:"Custom"})]}),t.desc&&e("p",{class:"text-sm text-gray-600 mt-1",children:t.desc})]},t.key))}),n===1&&e("div",{class:"max-h-[60vh] overflow-y-auto space-y-3 pr-1",children:s.web.map(t=>e(x,{feature:t,selected:u.some(a=>a.id===t.id),onToggle:()=>P(t)},t.id))}),n===2&&e("div",{class:"max-h-[60vh] overflow-y-auto space-y-3 pr-1",children:s.mobile.map(t=>e(x,{feature:t,selected:u.some(a=>a.id===t.id),onToggle:()=>P(t)},t.id))}),n===3&&e("div",{class:"space-y-4",children:[e("h3",{class:"text-lg font-semibold",children:"Summary"}),e("div",{class:"border rounded-xl p-4 bg-gray-50 space-y-2",children:[e("div",{class:"flex justify-between",children:[e("span",{children:"Base package"}),e("span",{children:["$",N]})]}),e("div",{class:"flex justify-between",children:[e("span",{children:"Extras"}),e("span",{children:["$",B]})]}),e("div",{class:"flex justify-between font-bold text-primary-700",children:[e("span",{children:"Total"}),e("span",{children:["$",k]})]})]}),e("label",{class:"block text-sm font-medium mb-1",children:"Spread over"}),e("select",{class:"w-full border rounded-lg p-2",value:y,onChange:t=>R(Number(t.target.value)),children:[e("option",{value:12,children:"12 months"}),e("option",{value:24,children:"24 months"})]}),e("p",{class:"text-gray-600",children:["From\xA0",e("span",{class:"font-semibold",children:["$",(k/y).toFixed(2),"/mo"]})]}),e("button",{class:"w-full bg-primary-600 text-white rounded-full py-3 font-semibold hover:bg-primary-700 transition-colors",onClick:()=>{let t={package:i,features:u.map(r=>({id:r.id,title:r.title,desc:r.desc,price:r.price,category:s.web.some(c=>c.id===r.id)?"web":"mobile"})),term:y,total:k},a=encodeURIComponent(JSON.stringify(t.features));window.location.href=`/checkout?package=${i}&features=${a}&term=${y}`},children:"Checkout \u2192"})]}),e("div",{class:"flex gap-3 pt-4",children:[e("button",{class:"flex-1 border rounded-full py-2 disabled:opacity-40 mb-10",disabled:n===0,onClick:()=>h(n-1),children:"Back"}),n<3&&e("button",{class:"flex-1 bg-primary-600 text-white rounded-full py-2 mb-10",onClick:()=>h(n+1),children:"Next"})]})]})]})}export{O as default};
